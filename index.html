<!-- FULL GAME CODE -->
<!-- Omniverse Universal Edition - Fixed & Enhanced -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Omniverse: Universal Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Orbitron:wght@500;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
:root { 
--primary:#00f3ff; 
--danger:#ff0044; 
--warn:#ffcc00; 
--glass:rgba(255,255,255,0.08);
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
body{
margin:0;overflow:hidden;background:#000;
font-family:'Orbitron',sans-serif;
touch-action:none;
}

/* Canvas */
#game-wrap{position:fixed;inset:0;background:#000}
canvas{width:100%;height:100%;display:block}

/* HUD */
#ui-layer{
position:absolute;inset:0;z-index:5;
pointer-events:none;padding:15px;
display:flex;flex-direction:column;justify-content:space-between;
}
.stat-panel{
background:rgba(0,0,0,0.55);
backdrop-filter:blur(6px);
border:1px solid rgba(255,255,255,0.15);
border-radius:8px;color:#fff;
padding:10px 15px;
box-shadow:0 0 15px rgba(0,255,255,0.15);
}
.hud-top{display:flex;justify-content:space-between}

/* Bars */
.bar-bg{width:130px;height:8px;background:#222;border-radius:4px;overflow:hidden;margin-top:4px}
.bar-fill{height:100%;transition:.15s}

/* Overlay Screen */
#overlay{
position:absolute;inset:0;z-index:50;
display:flex;align-items:center;justify-content:center;
background:linear-gradient(120deg,rgba(0,255,255,0.15),rgba(255,0,255,0.15),rgba(255,255,0,0.1));
backdrop-filter:blur(10px);
animation:bgFlow 6s linear infinite;
}
@keyframes bgFlow{
0%{filter:hue-rotate(0deg)}
100%{filter:hue-rotate(360deg)}
}

.overlay-box{
background:rgba(0,0,0,0.65);
border:2px solid rgba(0,255,255,0.4);
box-shadow:0 0 40px rgba(0,255,255,0.4);
padding:40px 50px;border-radius:20px;
text-align:center;
animation:glowPulse 2s infinite alternate;
}
@keyframes glowPulse{
0%{box-shadow:0 0 20px rgba(0,255,255,0.3)}
100%{box-shadow:0 0 45px rgba(255,0,255,0.5)}
}

h1{
font-family:'Black Ops One';
font-size:3.5rem;color:#fff;margin:0;
text-shadow:0 0 25px var(--primary);
}
p{color:#aaa;letter-spacing:2px}

/* Buttons */
.level-row{display:flex;gap:10px;justify-content:center;margin:20px 0}
.lvl-btn{
background:transparent;border:1px solid #666;
color:#aaa;padding:10px 18px;
cursor:pointer;border-radius:6px;
}
.lvl-btn.selected{
background:var(--primary);color:#000;
box-shadow:0 0 15px var(--primary);
}

.start-btn{
margin:10px;padding:14px 45px;
font-family:'Black Ops One';font-size:1.3rem;
background:linear-gradient(45deg,#ff0044,#ff9900);
border:none;color:#fff;border-radius:10px;
cursor:pointer;box-shadow:0 0 25px rgba(255,0,0,0.4);
transition:.2s;
}
.start-btn:hover{transform:scale(1.08)}
.mobile-btn{background:linear-gradient(45deg,#00f3ff,#00ff99)}

.hidden{display:none}

/* Mobile Controls */
#mobile-controls{
position:absolute;inset:0;z-index:20;display:none;
}
#touch-shield{position:absolute;inset:0}
.control-zone{
position:absolute;bottom:30px;display:flex;gap:18px;
}
.zone-left{left:25px}
.zone-right{right:25px;flex-direction:column;align-items:flex-end}
.t-btn{
width:85px;height:85px;border-radius:50%;
background:rgba(255,255,255,0.1);
border:2px solid rgba(255,255,255,0.4);
color:white;font-size:30px;
display:flex;align-items:center;justify-content:center;
backdrop-filter:blur(6px);
box-shadow:0 0 15px rgba(0,0,0,0.6);
}
.t-btn:active{background:rgba(0,243,255,0.5)}
.btn-jump{width:95px;height:95px;border-color:var(--primary)}
.btn-fire{width:75px;height:75px;border-color:var(--danger)}
</style>
</head>

<body>

<div id="game-wrap">
<canvas id="gameCanvas"></canvas>

<div id="ui-layer">
<div class="hud-top">
<div class="stat-panel">
<div id="hp-disp">‚ù§‚ù§‚ù§</div>
<div>SCORE: <span id="sc-disp" style="color:var(--primary)">0</span></div>
</div>
<div class="stat-panel">
<div style="font-size:10px">PLASMA</div>
<div class="bar-bg"><div id="ammo-fill" class="bar-fill" style="background:var(--warn);width:100%"></div></div>
<div style="font-size:10px;margin-top:6px">FUEL</div>
<div class="bar-bg"><div id="fuel-fill" class="bar-fill" style="background:var(--primary);width:100%"></div></div>
</div>
</div>
</div>

<!-- MOBILE -->
<div id="mobile-controls">
<div id="touch-shield"></div>
<div class="control-zone zone-left">
<div class="t-btn" id="btn-left">‚Üê</div>
<div class="t-btn" id="btn-right">‚Üí</div>
</div>
<div class="control-zone zone-right">
<div class="t-btn btn-fire" id="btn-fire">üî•</div>
<div class="t-btn btn-jump" id="btn-jump">üöÄ</div>
</div>
</div>

<!-- OVERLAY -->
<div id="overlay">
<div class="overlay-box">
<h1 id="titleText">OMNIVERSE</h1>
<p>UNIVERSAL EDITION</p>

<div class="level-row">
<button class="lvl-btn" onclick="setLevel(1)">1</button>
<button class="lvl-btn" onclick="setLevel(2)">2</button>
<button class="lvl-btn selected" onclick="setLevel(3)">3</button>
<button class="lvl-btn" onclick="setLevel(4)">4</button>
<button class="lvl-btn" onclick="setLevel(5)">5</button>
</div>

<button class="start-btn" onclick="startGame(false)">PLAY PC</button>
<button class="start-btn mobile-btn" onclick="startGame(true)">MOBILE</button>

<div style="margin-top:15px;font-size:12px;color:#aaa">
PC: Arrows + Space + F<br>
Mobile: Touch Controls (Landscape)
</div>
</div>
</div>

</div>

<script>
/* ========= FIXED GAME ENGINE ========= */

const c=document.getElementById("gameCanvas");
const ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight;}
addEventListener("resize",resize);resize();

let GRAVITY=0.6;
let GROUND_Y=()=>c.height-80;

let game={run:false,paused:false,frame:0,score:0,level:3,speed:6,ents:[],bullets:[],parts:[],bg:[],mobile:false};
let startLvl=3;
let input={l:false,r:false,u:false};

class Player{
constructor(){
this.x=80;this.y=GROUND_Y()-40;
this.w=40;this.h=40;
this.dy=0;this.hp=3;
this.fuel=100;this.ammo=10;
this.ground=true;this.jumps=0;
this.inv=0;this.leg=0;
}
upd(){
if(input.l) this.x=Math.max(0,this.x-5);
if(input.r) this.x=Math.min(c.width/2,this.x+5);

if(input.u && !this.ground && this.fuel>0){
this.dy-=0.8;this.fuel-=0.8;
}

this.dy+=GRAVITY;this.y+=this.dy;

if(this.y+this.h>=GROUND_Y()){
this.y=GROUND_Y()-this.h;this.dy=0;
this.ground=true;this.jumps=0;
this.fuel=Math.min(100,this.fuel+1.5);
}else this.ground=false;

if(this.ammo<10 && game.frame%60==0) this.ammo++;

if(this.inv>0) this.inv--;

document.getElementById("fuel-fill").style.width=this.fuel+"%";
document.getElementById("ammo-fill").style.width=(this.ammo*10)+"%";
}

jump(){
if(this.ground){
this.dy=-12;this.ground=false;this.jumps=1;
}else if(this.jumps<2){
this.dy=-11;this.jumps++;
}
}

drw(){
if(this.inv>0 && Math.floor(game.frame/5)%2) return;
ctx.save();ctx.translate(this.x,this.y);

this.leg=this.ground?this.leg+0.3:0.5;

/* glow */
ctx.shadowColor="#00f3ff";ctx.shadowBlur=15;

/* legs */
ctx.fillStyle="#777";
ctx.fillRect(8,40,8,15+Math.sin(this.leg)*10);
ctx.fillRect(24,40,8,15+Math.sin(this.leg+Math.PI)*10);

/* body */
ctx.shadowBlur=20;
ctx.fillStyle="#fff";
ctx.fillRect(0,0,40,40);

/* visor */
ctx.shadowBlur=0;
ctx.fillStyle="#0ff";
ctx.fillRect(18,10,18,8);

ctx.restore();
}

hit(d){
if(this.inv>0)return;
this.hp-=d;this.inv=60;
document.getElementById("hp-disp").innerText="‚ù§".repeat(this.hp);
if(this.hp<=0) gameOver();
}
}

let player=new Player();

/* Simple particles */
function spawnPart(x,y,n,c){
for(let i=0;i<n;i++){
game.parts.push({
x,y,c,
vx:(Math.random()-.5)*4,
vy:(Math.random()-.5)*4,
life:1
});
}
}

function loop(){
if(!game.run||game.paused) return;
requestAnimationFrame(loop);
game.frame++;game.score++;
document.getElementById("sc-disp").innerText=game.score;

/* background */
let g=ctx.createLinearGradient(0,0,0,c.height);
g.addColorStop(0,"#050015");
g.addColorStop(1,"#000");
ctx.fillStyle=g;ctx.fillRect(0,0,c.width,c.height);

/* ground */
ctx.fillStyle="#111";
ctx.fillRect(0,GROUND_Y(),c.width,c.height);

/* player */
player.upd();player.drw();

/* bullets */
game.bullets.forEach((b,i)=>{
b.x+=b.vx;
ctx.shadowColor="#0ff";ctx.shadowBlur=15;
ctx.fillStyle="#0ff";
ctx.fillRect(b.x,b.y,10,4);
ctx.shadowBlur=0;

if(b.x>c.width) game.bullets.splice(i,1);
});

/* particles */
game.parts.forEach((p,i)=>{
p.x+=p.vx;p.y+=p.vy;p.life-=0.04;
ctx.globalAlpha=p.life;ctx.fillStyle=p.c;
ctx.fillRect(p.x,p.y,4,4);ctx.globalAlpha=1;
if(p.life<=0) game.parts.splice(i,1);
});
}

function startGame(mob){
game.mobile=mob;
player=new Player();
game.run=true;game.paused=false;
game.score=0;game.frame=0;
game.bullets=[];game.parts=[];
document.getElementById("overlay").classList.add("hidden");
document.getElementById("mobile-controls").style.display=mob?"block":"none";
document.getElementById("hp-disp").innerText="‚ù§‚ù§‚ù§";
loop();
}

function gameOver(){
game.run=false;
document.getElementById("titleText").innerText="GAME OVER";
document.getElementById("overlay").classList.remove("hidden");
document.getElementById("mobile-controls").style.display="none";
}

/* Controls */
function fire(){
if(game.run && player.ammo>0){
player.ammo--;
game.bullets.push({x:player.x+45,y:player.y+22,vx:12});
spawnPart(player.x+45,player.y+22,6,"#0ff");
}
}
function jump(){if(game.run) player.jump();}

onkeydown=e=>{
if(e.code==="ArrowLeft") input.l=true;
if(e.code==="ArrowRight") input.r=true;
if(e.code==="Space"){e.preventDefault();input.u=true;jump();}
if(e.code==="KeyF") fire();
if(e.code==="KeyP"){game.paused=!game.paused;if(!game.paused)loop();}
}
onkeyup=e=>{
if(e.code==="ArrowLeft") input.l=false;
if(e.code==="ArrowRight") input.r=false;
if(e.code==="Space") input.u=false;
}

/* Mobile */
const map={ "btn-left":"l","btn-right":"r","btn-jump":"u","btn-fire":"f" };
Object.keys(map).forEach(id=>{
let el=document.getElementById(id);
el.addEventListener("touchstart",e=>{
e.preventDefault();
if(map[id]==="f") fire();
else if(map[id]==="u") jump();
else input[map[id]]=true;
},{passive:false});
el.addEventListener("touchend",e=>{
e.preventDefault();
if(map[id]!=="f") input[map[id]]=false;
},{passive:false});
});

/* Level */
function setLevel(n){
startLvl=n;
document.querySelectorAll(".lvl-btn").forEach((b,i)=>{
b.classList.toggle("selected",i+1===n);
});
}
</script>

</body>
</html>
